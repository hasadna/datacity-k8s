{{-
  include "cco.exec" dict
  "name" "set-sysadmin"
  "parameters" (list
    dict "name" "INSTANCE_NAME"
    dict "name" "SYSADMIN_NAME"
    dict "name" "NEW_SYSADMIN_PASSWORD" "default" "-"
    dict "name" "NEW_SYSADMIN_EMAIL" "default" "-"
  )"
  "exec_script" "
    if [ "${NEW_SYSADMIN_EMAIL}" == "-" ]; then
      kubectl -n $INSTANCE_ID exec deploy/ckan -c ckan -- ckan-paster --plugin=ckan sysadmin -c /etc/ckan/production.ini add $SYSADMIN_NAME
    else
      echo y | kubectl -n $INSTANCE_ID exec -i deploy/ckan -c ckan -- ckan-paster --plugin=ckan sysadmin -c /etc/ckan/production.ini add $SYSADMIN_NAME email=$NEW_SYSADMIN_EMAIL password=$NEW_SYSADMIN_PASSWORD
    fi
  "
}}
